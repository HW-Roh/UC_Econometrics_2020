---
title: "Intro to R"
subtitle: "Econometrics TA Session"
author: "Scribed by Roh"
date: "2020 Winter"
output:
  slidy_presentation:
    font_adjustment: +6
    highlight: pygments
    #css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, results = 'hide', size='Large')
```

## R

- This slide is a gentle introduction to R
- I listed basic and commonly used codes from the experience
- Some of them are not useful for this course but will be very useful later at some point
- Intentionally hide the output results! Please try to type and run it by yourself

## Basic Operations

- run single line: control/command + enter
- run selected code: select and control/command + enter
- run the entire file: control/command+shift+enter
- block comment: control/command+shift+c
```{r}
# Comment
getwd()
ls() # check list of variables
print('Hello')
```

## Variables

```{r}
num_var = 123
char_var = 'hello'
bool_var = TRUE
data_vec = c(1,2,3,4)
data_vec2 = c('hi','bye')
ls()
class(ls())
is.numeric(num_var)
class(is.numeric(num_var))
```

## Vector and More

```{r}
vec = c(2,2,NA,3.1415,0,3,3,NA)
str(vec) # structure
length(vec)
is.na(vec)
!is.na(vec)
sum(is.na(vec))
vec = vec[!is.na(vec)]
vec = round(vec, 2)
min(vec); max(vec); median(vec); mean(vec); var(vec)
is.unsorted(vec)
sort(vec) # default increasing
sort(vec, decreasing = TRUE)
```

## Continue on Vectors

```{r}
vec = c(vec, 5) # add
vec[-c(1,2,3,4)] # delete
vec[-1:-4] # delete
which(vec==3) # check
which.max(vec)
unique(vec) # unique
diff(vec) # diff

vec[2:length(vec)] # subsetting
vec>2
vec[c(TRUE,FALSE,TRUE,FALSE)]
vec[vec>2]

rbind(vec, vec+1)
cbind(vec, vec+1)
```

## Array
Two dimensional array is identical to the matrix 
```{r}
A = array(1:9, dim=c(3,3))
B = matrix(1:9, ncol=3, byrow=TRUE)
A; B
dim(A)
A%*%B
B[,3]=c(3,2,5)
solve(B) # inverse
det(B)
C = array(1:9, dim=c(3,3))
A*C # elementwise
A%*%C # matrix mul
```

## Continue on Array

```{r}
A == B
all(A==B)
which(A==B, arr.ind = TRUE)
A[A==B]; B[A==B]

E = array(1:12, dim = c(2,3,2))
E[,,1]
E[,2,]
E[1,,]
```

## List

```{r}
L <- list(
        name     = "Tom", 
        birthday = as.Date("2020-01-01"), 
        pet   = FALSE,
        major = c("Econ","Stat"),
        SAT = c(20,30,20,30)
      )
L[[1]]
L[[5]][2]
unlist(L)
```


## rep, seq, diag

```{r}
rep(0,5)
rep(c(1,2,3), 2)
rep(c(1,2,3),each = 2)

seq(5,0,length = 3)
seq(1,100)
seq(1,100,2)
x = c(1:100)
x[c(TRUE,FALSE)]

diag(3)
diag(c(1,2,3))

```


## Controls: if, if/else, for, function

```{r}
if(2>1){
  print("TRUE")
}else{
  print("FLASE")
}

for(i in seq(10)){
  print(i)
}

get_squared_value = function(x){
  return(sum(x^2))
}

get_squared_value(2)
```

## Illustration of LLN
```{r}
get_sample_mean_with_different_n = function(n){
  set.seed(2020)
  dist = c(rt(n, 10),
         runif(n, min = -5, max = 5),
         rpois(n, lambda = 4))
  sample_mean = array(dim = c(3,n))
  for (i in seq(n)){
    sample_mean[1,i] = mean(dist[1:n][1:i])
    sample_mean[2,i] = mean(dist[n:(2*n)][1:i])
    sample_mean[3,i] = mean(dist[(2*n):(3*n)][1:i])
  } 
  return(sample_mean)
}
```
```{r, echo=FALSE}
df = get_sample_mean_with_different_n(5000)
```

## Illustration of LLN
```{r,echo = FALSE, results = 'show', fig.width= 12, fig.height=5}
par(mfrow=c(1,3))
plot(df[1,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('t-dist with true mean 0')
abline(h=0 , col='red')

plot(df[2,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('Uniform with true mean 0')
abline(h=0 , col='red')

plot(df[3,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('Poisson with true mean 4')
abline(h=4 , col='red')
```

Reference: Quant Econ

## Illustration of CLT
We illustrate CLT on sampling distribution of mean.
```{r}
n=250
k=c(100,500,5000,50000)
Y = list()
for (i in k){
  idx = which(k==i)
  X_n = rep(0,k[idx])
  for (j in seq(i)){
    X_n[j] = mean(rexp(n,2))
  }
  Y[[idx]] = sqrt(n)*(X_n-rep(0.5,k[idx]))
}
```

##
```{r,echo = FALSE, results = 'show', fig.width= 10, fig.height=8}
par(mfrow=c(2,2))
hist(Y[[1]], breaks = 10, probability = TRUE, main='100 draws')
hist(Y[[2]], breaks = 25, probability = TRUE, main='500 draws')
hist(Y[[3]], breaks = 25, probability = TRUE, main='5000 draws')
hist(Y[[4]], breaks = 60, probability = TRUE, main='50000 draws')

```

Reference: Quant Econ