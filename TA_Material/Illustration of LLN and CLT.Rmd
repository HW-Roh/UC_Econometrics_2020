---
title: "Illustration of LLN and CLT"
author: "Roh"
date: "1/10/2020"
output:
  pdf_document: default
  html_document: default
subtitle: Econometric, Uchicago 2020
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


### LLN (Code)

  - We illustrate the classical IID LLN using simulation.
  - We would like to see how $\bar{X}$ chagnes with increasing $n$
  - We plot $\bar{X}$ on $n$. Check if $\bar{X}$ converges to $\mu$

```{r}
get_sample_mean_with_different_n = function(n){
  set.seed(2020)
  dist = c(rt(n, 10), # t-dist
         runif(n, min = -5, max = 5), # uniform
         rpois(n, lambda = 4)) # poisson
  sample_mean = array(dim = c(3,n))
  for (i in seq(n)){
    sample_mean[1,i] = mean(dist[1:n][1:i])
    sample_mean[2,i] = mean(dist[n:(2*n)][1:i])
    sample_mean[3,i] = mean(dist[(2*n):(3*n)][1:i])
  } 
  return(sample_mean)
}
```
```{r, echo=FALSE}
df = get_sample_mean_with_different_n(5000)
```

### LLN (Plot)
```{r,echo = FALSE, results = 'show', fig.width= 12, fig.height=5}
par(mfrow=c(1,3))
plot(df[1,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('t-dist with true mean 0')
abline(h=0 , col='red')

plot(df[2,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('Uniform with true mean 0')
abline(h=0 , col='red')

plot(df[3,], ylab = 'mean', xlab = '# of sample', type='l', col='blue', lwd='2')
title('Poisson with true mean 4')
abline(h=4 , col='red')
```

### CLT (Code)

We illustrate CLT on sampling distribution of sample mean from exponential distribution by following the steps

  0. Choose a distribution $F$ of our interest. Here, we choose exponential.
  1. Generate $k$ number of independent draws of $$Y_n = \sqrt{n}\cdot(\bar{X}_n -\mu)$$ with given $n$
  3. Test on different number of draws from $Y_n$
  4. Compare with histogram

```{r}
n=500
k=c(100,500,5000,100000)
Y = list()
for (i in k){
  idx = which(k==i)
  X_n = rep(0,k[idx])
  for (j in seq(i)){
    X_n[j] = mean(rexp(n,2))
  }
  Y[[idx]] = sqrt(n)*(X_n-rep(0.5,k[idx])) # generate observation of Y_n
}
```

### CLT(Plot)
```{r,echo = FALSE, results = 'show', fig.width= 10, fig.height=8}
par(mfrow=c(2,2))
hist(Y[[1]], breaks = 20, probability = TRUE, main='100 draws', xlab = NULL)
hist(Y[[2]], breaks = 40, probability = TRUE, main='500 draws', xlab = NULL)
hist(Y[[3]], breaks = 60, probability = TRUE, main='5000 draws', xlab = NULL)
hist(Y[[4]], breaks = 100, probability = TRUE, main='100000 draws', xlab = NULL)

```

Reference: Quant Econ[https://python.quantecon.org/lln_clt.html]
